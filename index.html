<!DOCTYPE html>
<html>

<!-- head -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tree Maintenance</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css" integrity="sha256-2pUeJf+y0ltRPSbKOeJh09ipQFYxUdct5nTY6GAXswA=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Germania+One|Source+Code+Pro">

  <link rel="stylesheet" href="css/main.css">
  <link rel="shortcut icon" href="favicon.ico">
  <!-- Icon created by favicon.io -->

  <script src="https://d3js.org/d3.v5.min.js"></script>
</head>

<!-- body -->
<body>

  <!-- header -->
  <section class="hero is-dark is-bold">
    <div class="hero-body">
      <div class="container">
        <h1 class="title">
          Visualization - Tree Maintenance
        </h1>
        <h2 class="subtitle">
          Chien-Yu Sung
        </h2>
      </div>
    </div>

    <div class="hero-foot">
      <div class="container">
        <nav class="navbar is-transparent" role="navigation" aria-label="main navigation">

          <div class="navbar-brand">
            <a role="button" class="navbar-burger burger" data-target="main-navbar" aria-label="menu" aria-expanded="false">
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>

          <div id="main-navbar" class="navbar-menu">
            <a class="navbar-item" href="#intro">
              <span class="icon">
                <i class="far fa-file-alt"></i>
              </span>
              <span>Introduction</span>
            </a>

            <a class="navbar-item" href="#data">
              <span class="icon">
                <i class="fas fa-table"></i>
              </span>
              <span>Dataset</span>
            </a>

            <a class="navbar-item" href="#proto">
              <span class="icon">
                <i class="fas fa-image"></i>
              </span>
              <span>Prototype</span>
            </a>

            <a class="navbar-item" href="#vis1">
              <span class="icon">
                <i class="fas fa-chart-bar"></i>
              </span>
              <span>Visualization 1</span>
            </a>

            <a class="navbar-item" href="#vis2">
              <span class="icon">
                <i class="fas fa-chart-area"></i>
              </span>
              <span>Visualization 2</span>
            </a>

            <a class="navbar-item" href="#about">
              <span class="icon">
                <i class="fas fa-user"></i>
              </span>
              <span>About Me</span>
            </a>
          </div>

        </nav>
      </div>
    </div>
  </section>

  <!-- introduction setcion -->
  <section id="intro" class="section">
    <div class="container content">
      <h2><a href="#intro" class="navigation">#</a> Introduction</h2>

      <p>
        The dataset I used in this project was <b>311 Cases</b> sourced from <a href="https://data.sfgov.org/City-Infrastructure/311-Cases/vw6y-z8j6" target="_blank">data.sfgov.org <i class="fas fa-external-link-alt"></i></a>.
        This project focused on visualizing <b>tree maintenance</b> data happened between <b>03/01/2018</b> and <b>03/01/2019</b>, especially with <b>geospatial</b> data, in order to get a better understanding about the stories underneath.
        I used <b>Python3</b> and <b>Tableau</b> for creating my prototype, and I used <b>D3.js</b> version 5 for implementing the visualization.
        The font styles used in this website are powered by <a href="https://fonts.google.com/" target="_blank">Google Fonts <i class="fas fa-external-link-alt"></i></a>.
        This is an open source project, all the source code can be found <a href="https://github.com/usf-cs360-spring2019/homework3-ohbriansung" target="_blank">here <i class="fas fa-external-link-alt"></i></a>.
      </p>
    </div>
  </section>

  <hr class="container">

  <!-- dataset setcion -->
  <section id="data" class="section">
    <div class="container content">
      <h2><a href="#data" class="navigation">#</a> Data</h2>

      <h3>Dataset 1 - Tree Maintenance March 2018 to 2019</h3>

      <p>
        Source: <a href="https://data.sfgov.org/City-Infrastructure/Tree-Maintenance-March-2018-to-2019/nm7r-4cxx?category=City-Infrastructure&view_name=Tree-Maintenance-March-2018-to-2019" target="_blank">data.sfgov.org <i class="fas fa-external-link-alt"></i></a><br/>
        Licence: <a href="https://opendatacommons.org/licenses/pddl/1.0/" target="_blank">ODC Public Domain Dedication and Licence <i class="fas fa-external-link-alt"></i></a><br/>
        Type: CSV<br/>
        Date: 04/02/2019
      </p>

      <table class="table is-bordered is-striped is-narrow is-fullwidth">
        <thead>
          <tr>
            <th style="width: 15ex">Attribution</th>
            <th style="width: 12ex">Value</th>
            <th>Sreenshot</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td>Size (MB)</td>
            <td>4.7</td>
            <td><img src="img/1_size.png"></td>
          </tr>
          <tr>
            <td>Rows</td>
            <td>11,478</td>
            <td><img src="img/1_row.png"></td>
          </tr>
          <tr>
            <td>Columns</td>
            <td>20</td>
            <td><img src="img/1_column.png"></td>
          </tr>
          <tr>
            <td>Data Types</td>
            <td colspan="2">String, Number, Datetime, Boolean, Location (Latitude and Longitude), URL</td>
          </tr>
        </tfoot>
      </table>

      <p>
        Data Processing:<br/>
        Used python to filter unused column and to create new data file.
        See source code <a href="https://github.com/usf-cs360-spring2019/homework3-ohbriansung/tree/gh-pages/data" target="_blank">here <i class="fas fa-external-link-alt"></i></a>.
      </p>

      <p>
        Used Columns:
      </p>

      <table class="table is-bordered is-striped is-narrow is-fullwidth">
        <thead>
          <tr>
            <th>Column</th>
            <th>Interpretation</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td>Source</td>
            <td>Mechanism or path by which the service request was received.</td>
          </tr>
          <tr>
            <td>Address</td>
            <td>Human readable address or description of location.</td>
          </tr>
          <tr>
            <td>Request Details</td>
            <td>The human readable name of the service request details.</td>
          </tr>
          <tr>
            <td>Opened</td>
            <td>The date and time when the service request was made.</td>
          </tr>
          <tr>
            <td>Closed</td>
            <td>The date and time when the service request was closed.</td>
          </tr>
          <tr>
            <td>Status</td>
            <td>A single-word indicator of the current state of the service request.</td>
          </tr>
          <tr>
            <td>Supervisor District</td>
            <td>San Francisco Supervisor District as defined in 'Supervisor Districts as of April 2012'.</td>
          </tr>
          <tr>
            <td>Neighborhood</td>
            <td>San Francisco Neighborhood as defined in 'SF Find Neighborhoods'.</td>
          </tr>
          <tr>
            <td>Latitude</td>
            <td>Latitude of the location, using the WGS84 projection.</td>
          </tr>
          <tr>
            <td>Longitude</td>
            <td>Longitude of the location, using the WGS84 projection.</td>
          </tr>
          <tr>
            <td>Media URL</td>
            <td>A URL to media associated with the request. Used to web scrape photos.</td>
          </tr>
        </tfoot>
      </table>

      <h3>Dataset 2 - Analysis Neighborhoods</h3>

      <p>
        Source: <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/Analysis-Neighborhoods/p5b7-5n3h" target="_blank">data.sfgov.org <i class="fas fa-external-link-alt"></i></a><br/>
        Licence: <a href="https://opendatacommons.org/licenses/pddl/1.0/" target="_blank">ODC Public Domain Dedication and Licence <i class="fas fa-external-link-alt"></i></a><br/>
        Type: GeoJSON<br/>
        Date: 04/04/2019
      </p>

      <table class="table is-bordered is-striped is-narrow is-fullwidth">
        <thead>
          <tr>
            <th style="width: 15ex">Attribution</th>
            <th style="width: 12ex">Value</th>
            <th>Sreenshot</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td>Size (MB)</td>
            <td>1.6</td>
            <td><img src="img/2_size.png"></td>
          </tr>
        </tfoot>
      </table>

      <h3>Dataset 3 - Streets - Active and Retired</h3>

      <p>
        Source: <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/Streets-Active-and-Retired/3psu-pn9h" target="_blank">data.sfgov.org <i class="fas fa-external-link-alt"></i></a><br/>
        Licence: <a href="https://opendatacommons.org/licenses/pddl/1.0/" target="_blank">ODC Public Domain Dedication and Licence <i class="fas fa-external-link-alt"></i></a><br/>
        Type: GeoJSON<br/>
        Date: 04/04/2019
      </p>

      <table class="table is-bordered is-striped is-narrow is-fullwidth">
        <thead>
          <tr>
            <th style="width: 15ex">Attribution</th>
            <th style="width: 12ex">Value</th>
            <th>Sreenshot</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td>Size (MB)</td>
            <td>13</td>
            <td><img src="img/3_size.png"></td>
          </tr>
        </tfoot>
      </table>

      <h3>Dataset 4 - Current Supervisor Districts</h3>

      <p>
        Source: <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/Current-Supervisor-Districts/8nkz-x4ny" target="_blank">data.sfgov.org <i class="fas fa-external-link-alt"></i></a><br/>
        Licence: <a href="https://opendatacommons.org/licenses/pddl/1.0/" target="_blank">ODC Public Domain Dedication and Licence <i class="fas fa-external-link-alt"></i></a><br/>
        Type: GeoJSON<br/>
        Date: 04/08/2019
      </p>

      <table class="table is-bordered is-striped is-narrow is-fullwidth">
        <thead>
          <tr>
            <th style="width: 15ex">Attribution</th>
            <th style="width: 12ex">Value</th>
            <th>Sreenshot</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td>Size (KB)</td>
            <td>448</td>
            <td><img src="img/4_size.png"></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </section>

  <hr class="container">

  <!-- prototype setcion -->
  <section id="proto" class="section">
    <div class="container content">
      <h2><a href="#proto" class="navigation">#</a> Prototype</h2>

      <img src="img/san_francisco_tree_maintenance_distribution.png" class="prototypes">
    </div>
  </section>

  <hr class="container">

  <!-- visualization setcion -->
  <section id="vis1" class="section">
    <div class="container content">
      <h2><a href="#vis1" class="navigation">#</a> D3 Visualization 1 - San Francisco Tree Maintenance Distribution</h2>

      <svg id="svg1" class="map">
        <g id="basemap"></g>
        <g id="streets" pointer-events="none"></g>
        <g id="outline" pointer-events="none"></g>
        <g id="records"></g>
        <g id="piechar"></g>
        <g id="legends"></g>
        <g id="tooltip" pointer-events="none"></g>
        <g id="details" pointer-events="none"></g>
        <g id="picture" pointer-events="none"></g>
        <g id="dslider"></g>
      </svg>

      <h3>Discussion</h3>

      <p>
        First, my D3 visualization is quite different from my prototype since it's very hard to customize the result when using Tableau and it doesn't support dark theme.
        The record was abundant so I split them into months.
        You can see that <b>Phone</b> and <b>Mobile/Open311</b> took the majority parts of the sources.
        I would say that the reason was because people or constructors could easily report the incidents with their phones.
        Furthermore, they would be able to take a picture and upload it instantly.
        There were lots of tree maintenance on <b>36th Avenue</b> in <b>August, 2018</b>.
        I couldn't find the reason online but I assumed that they scheduled a month to clean up all the demaged trees there.
        You are able to see the reasons and the pictures by hovering over the record symbols.
        There are several records from <b>Integrated Agency</b> with exactly same Latitude and Longitude, which made them overlapped, so I added some minor salt to distinguish them just a little bit.
        For example, in <b>August 2018</b> in <b>Excelsior</b> neighborhood.
        (See reference <a href="https://github.com/usf-cs360-spring2019/homework3-ohbriansung/blob/gh-pages/img/salt.png" target="_blank">here <i class="fas fa-external-link-alt"></i></a>)
        Overall, there was no certain pattern regarding the location of the tree maintenance.
        They were just everywhere in San Francisco!
      </p>

      <h3>Interactivity</h3>

      <p>
        0. Hovering over the record symbols shows details (and picture) of the record.<br/>
        1. Hovering over the record symbols highlights the legends, brushes pie chart, changes the content in pie.<br/>
        2. Hovering over the legends brushes the record and pie chart, changes the content in pie.<br/>
        3. Hovering over the arcs of the pie chart highlights the legends, brushes records, changes the content in pie.<br/>
        4. Hovering over the neighborhood highlights the boundaries and, shows the name and area ratio against entire SF.<br/>
        5. Draging the circle on the slider, clicking on the slider or ticks changes the data source by year and month.
      </p>

      <h3>Ratio Calculation</h3>

      <p>
        <b>Area Ratio</b>: After drawing the paths of basemap, use <b>foreach()</b> function to go through each neighborhood and calculate the area using <b>d3.geoArea()</b>.
        Put the result of each neighborhood and the total area into a dictionary for later use. (On line 134 of <i>vis.js</i> file)
<pre>d3.select("g#tooltip")
  .selectAll("path.land")
  .each(function(d) {
    let current = d3.geoArea(d);
    area.values[d.properties.nhood] = current;
    area.total += current;
  });</pre>
      </p>

      <p>
        <b>Source Ratio</b>: When calculating the X and Y coordinates on the projection, count the number of records of each source and the total.
        Put the result into a dictionary for later use. (On line 205 of <i>vis.js</i> file)
<pre>data.forEach(function(row) {
  let lat = parseFloat(row.Latitude);
  let lon = parseFloat(row.Longitude);
  let pixels = projection([lon, lat]);

  row.x = pixels[0];
  row.y = pixels[1];

  let source = row.Source;
  if (!(source in recordCount.values)) {
    recordCount.values[source] = 0;
  }
  recordCount.values[source]++;
  recordCount.total++;
});</pre>
      </p>

      <h3>Credits</h3>

      <p>
        0. <a href="https://bl.ocks.org/sjengle/2f6d4832397e3cdd78d735774cb5a4f2" target="_blank">SF Arrests Map <i class="fas fa-external-link-alt"></i></a> by Sophie Engle<br/>
        1. <a href="https://observablehq.com/@d3/conic-equal-area" target="_blank">Conic Equal Area <i class="fas fa-external-link-alt"></i></a> by D3<br/>
        2. <a href="https://github.com/d3/d3-geo/blob/master/README.md#geoArea" target="_blank">d3.geoArea() <i class="fas fa-external-link-alt"></i></a> by D3<br/>
        3. <a href="https://bl.ocks.org/mbostock/22994cc97fefaeede0d861e6815a847e" target="_blank">Circle Dragging I <i class="fas fa-external-link-alt"></i></a> by Mike Bostock<br/>
        4. <a href="https://bl.ocks.org/mbostock/1424037" target="_blank">SVG foreignObject Example <i class="fas fa-external-link-alt"></i></a> by Mike Bostock
      </p>
    </div>
  </section>

  <hr class="container">

  <section id="vis2" class="section">
    <div class="container content">
      <h2><a href="#vis2" class="navigation">#</a> D3 Visualization 2 - San Francisco Tree Maintenance Map</h2>

      <svg id="svg2" class="map">
        <g id="basemap"></g>
        <g id="outline" pointer-events="none"></g>
        <g id="legends"></g>
        <g id="details" pointer-events="none"></g>
      </svg>

      <h3>Discussion</h3>

      <p>
        Previously, I had a assumption that there was no certain pattern regarding the location of the tree maintenance.
        However, after I created another visualization using different data encoding, I had another conclusion that there did exist a pattern.
        District 3, A.K.A. Financial District, and District 4, A.K.A Sunset District, are well developed.
        Therefore, greenbelt in those areas would be considered less than other part of San Francisco.
        On the other hand, district 8 contains a lot of parks, mountains and peaks so there would be more trees in that area.
        That's why tree maintenance happened more frequently there.
      </p>

      <h3>Interactivity</h3>

      <p>
        0. Hovering over the district highlights the boundaries.<br/>
        1. Hovering over the district shows the details including number of records and ratio.<br/>
        2. Hovering over the district shows the tick on color legend.
      </p>

      <h3>Ratio Calculation</h3>

      <p>
        <b>Record Ratio</b>: Before drawing the basemap, use <b>foreach()</b> function to go through the dataset and count the record.
        Put the result of each district and the total number into a dictionary for later use. (On line 39 of <i>vis2.js</i> file)
<pre>data.forEach(function(row) {
  let dist = row["Supervisor District"];

  if (!(dist in dataCount.values)) {
    dataCount.values[dist] = 0;
  }

  dataCount.values[dist]++;
  dataCount.total++;
});</pre>
      </p>

      <h3>Credits</h3>

      <p>
        0. <a href="https://bl.ocks.org/sjengle/2f6d4832397e3cdd78d735774cb5a4f2" target="_blank">SF Arrests Map <i class="fas fa-external-link-alt"></i></a> by Sophie Engle<br/>
        1. <a href="https://blockbuilder.org/sjengle/0f3caca5c7329733cb8ed912d84807ed" target="_blank">Mobility Bubble Chart <i class="fas fa-external-link-alt"></i></a> by Sophie Engle<br/>
        2. <a href="https://github.com/d3/d3-scale/blob/master/README.md#_continuous" target="_blank">D3 Continuous Scales <i class="fas fa-external-link-alt"></i></a> by D3
      </p>

    </div>
  </section>

  <hr class="container">

  <!-- about section -->
  <section id="about" class="section">
    <div class="container content">
      <h2><a href="#about" class="navigation">#</a> About Me</h2>

      <div class="media">
        <div class="media-left">
          <p>
            <img src="img/me.jpg" class="profile-photo">
          </p>
        </div>

        <div class="media-content">
            <p>
              <strong>Chien-Yu Sung</strong>
              <br/>
              An enthusiastic and responsible man with ambition and creativity.
              Capable of working as a dedicated team member as well as an independent initiative taker.
              Proud <b>Taiwanese</b>!
              Currently, a 2nd year Master student in Computer Science at University of San Francisco who is graduating on May 18, 2019.
              The profile picture was taken in Yosemite National Park and I thought it would fit the topic perfectly.
              <br/>
              <br/>
              [ Interests ]<br/>
              <a class="interest theme-yellow"><i class="fas fa-globe-americas"></i> Distributed System</a><br/>
              <a class="interest theme-purple"><i class="fas fa-cubes"></i> Site Reliability</a><br/>
              <a class="interest theme-green"><i class="fas fa-shield-alt"></i> Cybersecurity</a><br/>
              <a class="interest theme-orange"><i class="fas fa-chart-pie"></i> Data Visualization</a><br/>
              <a class="interest theme-blue"><i class="fas fa-chess"></i> Board Games</a><br/>
            </p>

        </div>
      </div>

    </div>
  </section>

  <!-- footer -->
  <footer class="footer hero is-dark">
    <div class="content has-text-centered">
      <small>
        <a href="#top">
          <span class="fas fa-arrow-up"></span>
          <span>Back to Top</span>
        </a>
      </small>
      <br/>
      <br/>
      <a href="https://github.com/ohbriansung" target="_blank">
        <span class="fab fa-github"></span>
        <span>Github</span>
      </a>
      &bullet;
      <a href="https://www.linkedin.com/in/ohbriansung" target="_blank">
        <span class="fab fa-linkedin"></span>
        <span>LinkedIn</span>
      </a>
      &bullet;
      <a href="mailto:s254901282002@gmail.com">
        <span class="fas fa-envelope"></span>
        <span>Contact me</span>
      </a>
    </div>
  </footer>

  <script src="js/main.js"></script>
  <script src="vis.js"></script>
  <script src="vis2.js"></script>

<!-- end body and html -->
</body>
</html>
